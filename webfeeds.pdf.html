<!DOCTYPE html>
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <title>Using Web Feeds to Build Planet Sites in Ruby</title>
   
   

<style>
html, body { margin: 0; padding: 0; }

body { font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; }

a:link, a:visited { color: black; }

h1 { font-size: 30pt;  }
h2 { font-size: 28pt;  }
h3 { font-size: 25pt;  }
p, li, dt, dd, td, th { font-size: 18pt; }

pre { font-size: 14pt;  }
pre.small { font-size: 11pt; }

pre.code {
        background-color: azure;
        padding: 5px;
      }
     
ul { list-style-type: square; }    
   
.center { text-align: center; }   
     
.slide { page-break-after: always;
         min-height: 100mm;
         padding: 40px;
         
         border: 1px dotted black;

/*      
  background: -moz-linear-gradient( top, maroon, red);
*/
       }


pre {
  padding: 4px 4px 4px 4px;
  border-top: #bbb 1px solid;
  border-bottom: #bbb 1px solid;
  background: #f3f3f3;
}



/*
for princexml (CSS3 paged media support)
@page { size: A4 landscape }
*/
</style>

</head>
<body>

<div class="presentation">

<div class='slide '>
<!-- === begin markdown block ===

      generated by markdown 1.1.1 on Ruby 1.9.2 (2011-07-09) [i386-mingw32]
                on 2013-11-13 19:14:23 +0100 with Markdown engine kramdown (1.2.0)
                  using options {}
  -->


<!-- _S9SLIDE_ -->
<h1 id="using-web-feeds-to-build-planet-sites-in-ruby">Using Web Feeds to Build Planet Sites in Ruby</h1>

<p>Agenda</p>

<ul>
  <li>What&#8217;s a Web Feed?</li>
  <li>What&#8217;s a Planet?</li>
  <li>Why Planet? What&#8217;s Planet Planet?</li>
  <li>What&#8217;s Pluto?</li>
  <li>Reading Web Feeds in Ruby  - <code>RSS::Rss</code></li>
  <li>Reading Web Feeds in Ruby  - <code>RSS::Atom::Feed</code></li>
  <li>Who Cares? Let&#8217;s Normalize - A Web Feed is a Web Feed is a Web Feed</li>
  <li>Planet Feed Reader in 20 Lines of Ruby</li>
  <li>Production-Ready? Real-World World Feed Reader?</li>
  <li><code>planet.rb</code> - Using the Pluto Gem w/ Sinatra</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="whats-a-web-feed">What&#8217;s a Web Feed?</h1>

<p><img src="i/web-feed-icon.png" style="float: right;" /></p>

<p>A web feed (or news feed) is a simple data format
that 1) lets you publish a list of
status updates, blog postings, articles, pictures, recordings, etc
and that 2) lets others subscribe to your updates.</p>

<p>Example:</p>

<pre><code>&lt;feed&gt;
  &lt;title&gt;Floor Drees » blog&lt;/title&gt;
  &lt;link href="http://www.1stfloorgraphics.nl" /&gt;
  &lt;updated&gt;2013-10-23T13:54:22Z&lt;/updated&gt;
  &lt;entry&gt;
    &lt;title&gt;DevFest Vienna, Day 1 &amp; 2: Talks, Presentations and Hacking&lt;/title&gt;
    &lt;link href="http://www.1stfloorgraphics.nl/2013/10/23/devfest-vienna-day-1-2-talks-presentations-and-hacking/" /&gt;
    &lt;published&gt;2013-10-23T13:54:22Z&lt;/published&gt;
    &lt;summary&gt;A tad overdue, but still: my recap of this years Vienna DevFest...&lt;/summary&gt;
    ...
  &lt;/entry&gt;
  &lt;entry&gt;
    &lt;title&gt;Time for a new adventure at CheckiO&lt;/title&gt;
    &lt;link href="http://www.1stfloorgraphics.nl/2013/10/21/time-for-a-new-adventure-at-checkio/" /&gt;
    &lt;published&gt;2013-10-21T07:00:07Z&lt;/published&gt;
    &lt;summaray&gt;It's time for a personal announcement - I heard that's what a blog is for anyway...&lt;/summary&gt;
  ...
&lt;/feed&gt;
</code></pre>

<p><a href="http://www.1stfloorgraphics.nl/blog/feed/atom/">(Source: <code>1stfloorgraphics.nl/blog/feed</code>)</a></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="whats-a-planet">What&#8217;s a Planet?</h1>

<p>It&#8217;s a kind of Do-It-Yourself Facebook Newsfeed:</p>

<p>Step 1) Read a list of web feeds.</p>

<p>Step 2) Mix up all postings in a new page.</p>

<p>Step 3) Serve and enjoy.</p>

<p>Example: Planet Vienna.rb</p>

<p><img src="i/planet-viennarb.png" alt="" /></p>

<p>Example: Planet Vienna.rb - Alternative Design / Style</p>

<p><img src="i/planet-viennarb-ii.png" alt="" /></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="why-planet-whats-planet-planet">Why Planet? What&#8217;s Planet Planet?</h1>

<p>In an age long before Facebook in the year 2004:</p>

<p>Planet Planet <a href="http://www.planetplanet.org">(<code>planetplanet.org</code>)</a> - very first
free planet scripts and templates (by Scott James Remnant and Jeff Waugh) in Python
for reading web feeds and building new web pages;
used for Planet Gnome <a href="https://planet.gnome.org">(<code>planet.gnome.org</code>)</a> (<a href="https://planet.gnome.org/heads/">Hackergotchi Heads</a>)
and Planet Debian <a href="http://planet.debian.org/">(<code>planet.debian.org</code>)</a> (still running today!).</p>

<p>More Planets:</p>

<p><a href="http://planet.ubuntu.com">Planet Ubuntu</a>  •
<a href="http://planet.fedoraproject.org">Planet Fedora</a>  •
<a href="http://planet.freedesktop.org">Planet Free Desktop</a>  •
<a href="http://planetkde.org">Planet KDE</a>  •
<a href="http://planet.mozilla.org">Planet Mozilla</a>  •
<a href="http://planet.firefox.com">Planet Firefox</a>  •
<a href="http://planet.documentfoundation.org">Planet Document Foundation</a>  •
<a href="http://planet.apache.org/committers">Planet Apache</a>  •
<a href="http://planet.wordpress.org">Planet WordPress</a>  •
<a href="http://drupal.org/planet">Planet Drupal</a>  •
<a href="http://www.planetdjango.org">Planet Django</a>  •
<a href="http://planet.parrotcode.org">Planet Parrot</a>  •
<a href="http://planet.haskell.org">Planet Haskell</a>  •
<a href="http://plutolive.herokuapp.com/ruby">Planet Ruby</a>  •
<a href="http://plutolive.herokuapp.com/js">Planet JavaScript</a>  •
<a href="http://plutolive.herokuapp.com/dart">Planet Dart</a>  •
<a href="http://viennarb.herokuapp.com">Planet Vienna.rb</a>  •
and many many more.</p>

<p>Your Planet? </p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="whats-pluto">What&#8217;s Pluto?</h1>

<p><img src="i/pluto-logo.png" style="float: right;" /></p>

<p>A <a href="http://feedreader.github.io">free planet site generator</a> in Ruby (Yes!)
that lets you build web pages from published web feeds.</p>

<p>Use the <code>pluto</code> command line tool and pass in one or more planet configuration files.
Example:</p>

<pre><code>$ pluto build viennarb.ini
</code></pre>

<p>This will</p>

<p>1) fetch all feeds listed in <code>viennarb.ini</code> and</p>

<p>2) store all entries in a local database, that is, <code>viennarb.db</code> in your working folder and</p>

<p>3) generate a planet web page, that is, <code>viennarb.html</code> using the blank template pack in your working folder using all feed entries from the local database.</p>

<p>Open up <code>viennarb.html</code> to see your planet web page. Voila!</p>

<p>Appendix: <code>viennarb.ini</code></p>

<pre><code>title  = Planet Vienna.rb

[viennarb]
  title   = Vienna.rb Blog
  link    = http://vienna-rb.at
  feed    = http://vienna-rb.at/atom.xml

[viennarbmeetup]
  title = Vienna.rb Meetups
  link  = http://www.meetup.com/vienna-rb
  feed  = http://www.meetup.com/vienna-rb/events/rss/vienna.rb/

[floor]
  title  = Floor Drees's Blog
  link   = http://www.1stfloorgraphics.nl/blog/
  feed   = http://www.1stfloorgraphics.nl/blog/feed/
  github = FloorD

[pxlpnk]
  title  = Andreas Tiefenthaler's Blog
  link   = http://lab.an-ti.eu
  feed   = http://lab.an-ti.eu/atom.xml
  github = pxlpnk

[abangratz]
  title  = Anton Bangratz's Blog
  link   = http://abangratz.github.io
  feed   = http://abangratz.github.io/atom.xml
  github = abangratz
  
...
</code></pre>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="reading-web-feeds-in-ruby----rssrss">Reading Web Feeds in Ruby  - <code>RSS::Rss</code></h1>

<h2 id="rss---really-simple-syndication--rich-site-summary">1) RSS - Really Simple Syndication / Rich Site Summary</h2>

<pre><code>require 'rss'
require 'open-uri'

xml = open( 'http://www.1stfloorgraphics.nl/blog/feed' ).read

feed = RSS::Parser.parse( xml )

puts "feed.class.name: #{feed.class.name}"

puts "== #{feed.channel.title} =="

feed.items.each do |item|
  puts "- #{item.title}"
  puts "  (#{item.link})"
  puts
end
</code></pre>

<p>Prints:</p>

<pre><code>feed.class.name: RSS::Rss

== Floor Drees » blog ==

- DevFest Vienna, Day 1 &amp; 2: Talks, Presentations and Hacking
  (http://www.1stfloorgraphics.nl/2013/10/23/devfest-vienna-day-1-2-talks-presentations-and-hacking/)

- Time for a new adventure at CheckiO
  (http://www.1stfloorgraphics.nl/2013/10/21/time-for-a-new-adventure-at-checkio/)

- DevFest Vienna Day 0, 18 October
  (http://www.1stfloorgraphics.nl/2013/10/19/devfest-vienna-day-0-18-october/)

- Can we talk about programming again?
  (http://www.1stfloorgraphics.nl/2013/10/18/can-we-talk-about-programming-again/)

- Ruby resources for those getting started
  (http://www.1stfloorgraphics.nl/2013/10/17/ruby-resources-for-those-getting-started/)

- RuPy Budapest 2013 – the day after
  (http://www.1stfloorgraphics.nl/2013/10/14/rupy-budapest-2013-the-day-after/)

- Arrrrcamp 2013 – a recap
  (http://www.1stfloorgraphics.nl/2013/10/10/arrrrcamp-2013-a-recap/)

- WordCamp Europe 2013 – a recap
  (http://www.1stfloorgraphics.nl/2013/10/06/wordcamp-europe-2013-a-recap/)

- Working towards great version control for content creators / talk excerpt #wceu 2013
  (http://www.1stfloorgraphics.nl/2013/10/06/working-towards-great-version-control-for-content-creators-talk-excerpt

- How to survive the holidays as a Techie
  (http://www.1stfloorgraphics.nl/2013/10/05/how-to-survive-the-holidays-as-a-techie/)
</code></pre>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="reading-web-feeds-in-ruby----rssatomfeed">Reading Web Feeds in Ruby  - <code>RSS::Atom::Feed</code></h1>

<h2 id="atom">2) ATOM</h2>

<pre><code>require 'rss'
require 'open-uri'

xml = open( 'http://www.1stfloorgraphics.nl/blog/feed/atom' ).read

feed = RSS::Parser.parse( xml )

puts "feed.class.name: #{feed.class.name}"

puts "== #{feed.title.content} =="

feed.entries.each do |entry|
  puts "- #{entry.title.content}"
  puts "  (#{entry.link.href})"
  puts
end
</code></pre>

<p>Prints:</p>

<pre><code>feed.class.name: RSS::Atom::Feed

== Floor Drees » blog ==
- DevFest Vienna, Day 1 &amp;amp; 2: Talks, Presentations and Hacking
  (http://www.1stfloorgraphics.nl/2013/10/23/devfest-vienna-day-1-2-talks-presentations-and-hacking/)

- Time for a new adventure at CheckiO
  (http://www.1stfloorgraphics.nl/2013/10/21/time-for-a-new-adventure-at-checkio/)

- DevFest Vienna Day 0, 18 October
  (http://www.1stfloorgraphics.nl/2013/10/19/devfest-vienna-day-0-18-october/)

- Can we talk about programming again?
  (http://www.1stfloorgraphics.nl/2013/10/18/can-we-talk-about-programming-again/)

- Ruby resources for those getting started
  (http://www.1stfloorgraphics.nl/2013/10/17/ruby-resources-for-those-getting-started/)

- RuPy Budapest 2013 &amp;#8211; the day after
  (http://www.1stfloorgraphics.nl/2013/10/14/rupy-budapest-2013-the-day-after/)

- Arrrrcamp 2013 &amp;#8211; a recap
  (http://www.1stfloorgraphics.nl/2013/10/10/arrrrcamp-2013-a-recap/)

- WordCamp Europe 2013 &amp;#8211; a recap
  (http://www.1stfloorgraphics.nl/2013/10/06/wordcamp-europe-2013-a-recap/)

- Working towards great version control for content creators / talk excerpt #wceu 2013
  (http://www.1stfloorgraphics.nl/2013/10/06/working-towards-great-version-control-for-content-creators-talk-excerpt-wceu-2013/)

- How to survive the holidays as a Techie
  (http://www.1stfloorgraphics.nl/2013/10/05/how-to-survive-the-holidays-as-a-techie/)
</code></pre>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="whats-the-difference--rss-vs-atom">What&#8217;s the difference?  RSS vs ATOM</h1>

<table>
  <thead>
    <tr>
      <th>RSS</th>
      <th>ATOM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>feed.channel.title</code></td>
      <td><code>feed.title.content</code></td>
    </tr>
    <tr>
      <td><code>item.title</code></td>
      <td><code>entry.title.content</code></td>
    </tr>
    <tr>
      <td><code>item.link</code></td>
      <td><code>entry.link.href</code></td>
    </tr>
  </tbody>
</table>

<p>RSS:</p>

<pre><code>&lt;rss version="2.0"&gt;
  &lt;channel&gt;
    &lt;title&gt;Floor Drees » blog&lt;/title&gt;
    &lt;link&gt;http://www.1stfloorgraphics.nl&lt;/link&gt;
    &lt;lastBuildDate&gt;Wed, 23 Oct 2013 13:54:22 +0000&lt;/lastBuildDate&gt;
    &lt;item&gt;
      &lt;title&gt;DevFest Vienna, Day 1 &amp; 2: Talks, Presentations and Hacking&lt;/title&gt;
      &lt;link&gt;http://www.1stfloorgraphics.nl/2013/10/23/devfest-vienna-day-1-2-talks-presentations-and-hacking/&lt;/link&gt;
      &lt;pubDate&gt;Wed, 23 Oct 2013 13:54:22 +0000&lt;/pubDate&gt;
      &lt;description&gt;A tad overdue, but still: my recap of this years Vienna DevFest...&lt;/description&gt;
    &lt;/item&gt;
    ...
  &lt;/channel&gt;
&lt;/rss&gt;
</code></pre>

<p><a href="http://www.1stfloorgraphics.nl/blog/feed/">(Source: <code>1stfloorgraphics.nl/blog/feed</code>)</a></p>

<p>ATOM:</p>

<pre><code>&lt;feed xmlns="http://www.w3.org/2005/Atom"&gt;
  &lt;title type="text"&gt;Floor Drees » blog&lt;/title&gt;
  &lt;link rel="alternate" type="text/html" href="http://www.1stfloorgraphics.nl" /&gt;
  &lt;updated&gt;2013-10-23T13:54:22Z&lt;/updated&gt;
  &lt;entry&gt;
    &lt;title type="html"&gt;DevFest Vienna, Day 1 &amp;amp; 2: Talks, Presentations and Hacking&lt;/title&gt;
    &lt;link rel="alternate" type="text/html" href="http://www.1stfloorgraphics.nl/2013/10/23/devfest-vienna-day-1-2-talks-presentations-and-hacking/" /&gt;
    &lt;published&gt;2013-10-23T13:54:22Z&lt;/published&gt;
    &lt;summary type="html"&gt;A tad overdue, but still: my recap of this years Vienna DevFest...&lt;/summary&gt;
  &lt;/entry&gt;
  ...
&lt;/feed&gt;
</code></pre>

<p><a href="http://www.1stfloorgraphics.nl/blog/feed/atom/">(Source: <code>1stfloorgraphics.nl/blog/feed/atom</code>)</a></p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="who-cares-lets-normalize---a-web-feed-is-a-web-feed-is-a-web-feed">Who Cares? Let&#8217;s Normalize - A Web Feed is a Web Feed is a Web Feed</h1>

<p>Uniform title, link, summary, content, etc. (for standard case):</p>

<pre><code>require 'feedutils'
require 'open-uri'

xml = open( 'http://www.1stfloorgraphics.nl/blog/feed' ).read 
# xml = open( 'http://www.1stfloorgraphics.nl/blog/feed/atom' ).read

feed = FeedUtils::Parser.parse( xml )

puts "feed.class.name: #{feed.class.name}"

puts "== #{feed.title} =="

feed.items.each do |item|
  puts "- #{item.title}"
  puts "  (#{item.url})"
  puts
end

</code></pre>

<p>Prints:</p>

<pre><code>feed.class.name: FeedUtils::Feed

== Floor Drees » blog ==

- DevFest Vienna, Day 1 &amp; 2: Talks, Presentations and Hacking
  (http://www.1stfloorgraphics.nl/2013/10/23/devfest-vienna-day-1-2-talks-presentations-and-hacking/)

...
</code></pre>

<p>More Ruby gems feed options:</p>

<ul>
  <li><a href="http://rubygems.org/gems/feedutils">feedutils</a></li>
  <li><a href="http://rubygems.org/gems/feed-normalizer">feed-normalizer</a></li>
  <li><a href="http://rubygems.org/gems/simple-rss">simple-rss</a></li>
  <li><a href="http://rubygems.org/gems/feedzirra">feedzirra</a></li>
  <li>and others</li>
</ul>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="planet-feed-reader-in-20-lines-of-ruby">Planet Feed Reader in 20 Lines of Ruby</h1>

<p><code>planet.rb</code>:</p>

<pre><code>require 'open-uri'
require 'feedutils'
require 'erb'
  
# step 1) read a list of web feeds

FEEDS = [
  'http://vienna-rb.at/atom.xml',
  'http://www.meetup.com/vienna-rb/events/rss/vienna.rb/',
  'http://www.1stfloorgraphics.nl/blog/feed/',
  'http://lab.an-ti.eu/atom.xml',
  'http://abangratz.github.io/atom.xml'
]

items = []
  
FEEDS.each do |url|
  feed = FeedUtils::Parser.parse( open( url ).read )
  items += feed.items
end

# step 2) mix up all postings in a new page

FEED_ITEM_TEMPLATE = &lt;&lt;EOS
&lt;% items.each do |item| %&gt;
  &lt;div class="item"&gt;
    &lt;h2&gt;&lt;a href="&lt;%= item.url %&gt;"&gt;&lt;%= item.title %&gt;&lt;/a&gt;&lt;/h2&gt;
    &lt;div&gt;&lt;%= item.content %&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;% end %&gt;
EOS

puts ERB.new( FEED_ITEM_TEMPLATE ).result
</code></pre>

<p>Run the script:</p>

<pre><code>$ ruby planet.rb      
</code></pre>

<p>Prints:</p>

<pre><code>&lt;div class="item"&gt;
  &lt;h2&gt;&lt;a href="http://vienna-rb.at/blog/2013/11/06/picks/"&gt;Picks / what the vienna.rb team thinks is worth sharing this week&lt;/a&gt;&lt;/h2&gt;
  &lt;div&gt;
   &lt;h3&gt;6/11 Picks!!&lt;/h3&gt;
   &lt;p&gt;In a series on this website we'll entertain YOU with our picks...
 ...
</code></pre>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="production-ready-real-world-planet-feed-reader-almost">Production-Ready? Real-World Planet Feed Reader? Almost</h1>

<p>1) Cache (Store) Feed Items in Database</p>

<p>e.g. lets you use <code>items.latest.limit(24)</code> and so on (SQL queries)</p>

<p>2) Use Conditional GETs When Fetching Feeds</p>

<p>e.g. use HTTP Header <code>If-Modified-Since</code> for last modified dates and <code>If-None-Match</code> for etags</p>

<p>3) Schedule Feed Auto Update Every Hour</p>

<p>e.g. use <code>rake update</code>  w/ cron job, for example</p>

<p>That&#8217;s it.  Goodies ready for (re)use in pluto gem.</p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="planetrb---using-the-pluto-gem-w-sinatra"><code>planet.rb</code> - Using the Pluto Gem w/ Sinatra</h1>

<p>planet.rb:</p>

<pre><code>class Planet &lt; Sinatra::Base

  include Pluto::Models   # Models e.g. Feed, Item, Site, etc.

  get '/' do
    erb :index, locals: { items: Items.latest.limit(24) }
  end

end
</code></pre>

<p>index.erb:</p>

<pre><code>&lt;% items.each do |item| %&gt;

  &lt;div class='item'&gt;

    &lt;h2 class='item-title'&gt;
     &lt;%= link_to item.title, item.url %&gt;
    &lt;/h2&gt;

    &lt;div class='item-content'&gt;
     &lt;%= item.content %&gt;
    &lt;/div&gt;
  &lt;/div&gt;

&lt;% end %&gt;
</code></pre>

<p>See the <a href="https://github.com/feedreader/pluto.live.starter">pluto.live.starter</a> repo for more.</p>


</div>
<div class='slide '>
<!-- _S9SLIDE_ -->
<h1 id="thanks---questions-comments">Thanks - Questions? Comments?</h1>

<h2 id="links">Links</h2>

<p>Planet Vienna.rb  -&gt; <a href="http://viennarb.herokuapp.com"><code>viennarb.herokuapp.com</code></a></p>

<p>Planet Ruby  -&gt;  <a href="http://plutolive.herokuapp.com"><code>plutolive.herokuapp.com</code></a></p>

<p>Pluto Planet Feed Reader Tools  -&gt;  <a href="https://github.com/feedreader"><code>github.com/feedreader</code></a></p>

<!-- === end markdown block === -->
</div>


  </div> <!-- presentation -->
</body>
</html> 

